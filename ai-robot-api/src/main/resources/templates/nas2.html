<!DOCTYPE html system "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script src="/libs/jquery-1.11.0.min.js"></script>

    <!-- import Vue before Element -->
<!--    <script src="https://unpkg.com/vue/dist/vue.js"></script>-->
    <script src="/libs/vue/vue.js"></script>
    <!-- import JavaScript -->
<!--    <script src="https://unpkg.com/element-ui/lib/index.js"></script>-->
    <script src="/libs/vue/element-ui.js"></script>

    <!-- import CSS -->
<!--    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">-->
    <link rel="stylesheet" href="/css/element-ui.css">

</head>
<body>
<!--<div id="test">-->
<!--    <span th:text="${msg}">span默认文本内容</span><br/>-->
<!--</div>-->


<div id="app">
    <!--    <el-button @click="visible = true">Button</el-button>-->
    <!--    <el-dialog :visible.sync="menuVisible" title="Hello world">-->
    <!--        <p>Try Element</p>-->
    <!--    </el-dialog>-->

    <el-upload
            class="upload-demo inline-block"
            action="http://localhost:8090//nas/upload"
            :on-preview="handlePreview"
            :on-remove="handleRemove"
            :before-remove="beforeRemove"
            multiple
            :limit="3"
            :on-exceed="handleExceed"
            :file-list="fileList">
        <!--        <el-button size="small" type="primary">点击上传</el-button>-->
        <el-button type="primary">上传<i class="el-icon-upload el-icon--right"></i></el-button>
        <div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
    </el-upload>
    <el-button type="primary" icon="el-icon-download"></el-button>
    <el-button type="primary" icon="el-icon-folder-add"></el-button>
    <el-button type="primary" icon="el-icon-edit"></el-button>
    <el-button type="primary" icon="el-icon-delete"></el-button>
    <el-button type="primary" icon="el-icon-share"></el-button>
    <el-button type="primary">复制到</el-button>
    <el-button type="primary">移动到</el-button>


    <!--    <div :inline="true">-->

    <!--    </div>-->
    <el-input placeholder="请输入内容" style="width: 200px;padding-left: 50px" :inline="true"></el-input>
    <el-button type="primary" icon="el-icon-search" :inline="true">搜索</el-button>


    <el-table :data="tableData" key="Math.random()" @row-click="click"
              @row-contextmenu="rightClick" stripe style="width: 100%">
        <el-table-column prop="folder" label="" width="80">
            <i class="el-icon-folder"></i>
        </el-table-column>
        <el-table-column prop="document" label="" width="80">
            <i class="el-icon-document"></i>
        </el-table-column>
        <el-table-column prop="name" label="名称"></el-table-column>
        <el-table-column prop="size" label="文件大小"></el-table-column>
        <el-table-column prop="updateDate" label="更新日期"></el-table-column>
        <el-table-column prop="updateBy" label="更新人"></el-table-column>
        <el-table-column label="操作" fixed="right" width="180">
            <el-col :span="10">
                <el-tooltip effect="dark" content="编辑当前行" placement="top">
                    <el-button size="mini" @click="dengmiQueryForm.dialogVisible = true">编辑</el-button>
                </el-tooltip>
            </el-col>
        </el-table-column>
    </el-table>


    <div id="contextmenu" class="menu" v-show="menuVisible">
        <div class="contextmenu__item" @click="ShowView(CurrentRow)">查看</div>
        <div class="contextmenu__item" @click="EditData(CurrentRow)">修改</div>
    </div>
</div>

</body>

<script>
    new Vue({
        el: '#app',
        data: {
            fileList: [],
            tableData: [],
            menuVisible: false,
            input: null,
        },
        mounted: function () {
            this.getChildFiles('/');
        },
        methods: {
            handleRemove(file, fileList) {
                console.log('handleRemove', file, fileList);
            },
            handlePreview(file) {
                console.log('handlePreview', file);
            },
            handleExceed(files, fileList) {
                console.log('handleExceed', file);
                this.$message.warning(`当前限制选择 3 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);
            },
            beforeRemove(file, fileList) {
                console.log('beforeRemove', file);
                return this.$confirm(`确定移除 ${file.name}？`);
            },
            getChildFiles(filePath) {
                console.log("filePath=  " + filePath);
                const self = this;
                $.ajax(
                    {
                        url: '/nas/getChild',
                        data: {filePath: filePath},   // 需要传送的参数
                        type: 'POST',   // 请求方式
                        dataType: 'json', // 返回数据的格式, 通常为JSON
                        contentType: 'application/json',
                        success: function (response) { // 请求成功后的回调函数
                            console.log("Send Request success response=  " + JSON.stringify(response));
                            self.tableData = response.list;
                            <!--                        console.log("tableData=  " + JSON.stringify(self.tableData));-->
                        },
                        error: function (response) {
                            console.log('Send Request Fail..' + JSON.stringify(response)); // 请求失败时的回调函数
                        }
                    }
                );
            },
            setCurrentRow() {
                console.log("setCurrentRow");
            },
            click(row) {
                console.log("click= " + JSON.stringify(row));
                if (row.type === 'dir') {
                    console.log("row.parentName= " + row.parentName);
                    this.getChildFiles(row.parentName);
                }
            },
            rightClick(row, column, event) {
                // this.testModeCode = row.testModeCode
                // this.menuVisible = false // 先把模态框关死，目的是 第二次或者第n次右键鼠标的时候 它默认的是true
                this.menuVisible = true // 显示模态窗口，跳出自定义菜单栏
                event.preventDefault() //关闭浏览器右键默认事件
                this.CurrentRow = row
                const menu = document.querySelector('#app .menu');
                console.log("menu= " + menu)
                this.styleMenu(menu)
            },
            styleMenu(menu) {
                if (event.clientX > 1800) {
                    menu.style.left = event.clientX - 100 + 'px'
                } else {
                    menu.style.left = event.clientX + 1 + 'px'
                }
                document.addEventListener('click', this.foo) // 给整个document新增监听鼠标事件，点击任何位置执行foo方法
                if (event.clientY > 700) {
                    menu.style.top = event.clientY - 30 + 'px'
                } else {
                    menu.style.top = event.clientY - 10 + 'px'
                }
            },
            foo() {
                this.menuVisible = false;
                // 及时关掉监听
                document.removeEventListener('click', this.foo);
            },
        }
    })


</script>


<style>
    /* 解决 上传下载按钮 不能再一行显示 */
    .inline-block {
        display: inline-block;
    }

    /* 解决 上传下载按钮 不能再一行显示 */


    .contextmenu__item {
        display: block;
        line-height: 34px;
        text-align: center;
    }

    .contextmenu__item:not(:last-child) {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .menu {
        position: absolute;
        background-color: #fff;
        width: 100px;
        /*height: 106px;*/
        font-size: 12px;
        color: #444040;
        border-radius: 4px;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        border-radius: 3px;
        border: 1px solid rgba(0, 0, 0, 0.15);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
        white-space: nowrap;
        z-index: 1000;
    }

    .contextmenu__item:hover {
        cursor: pointer;
        background: #66b1ff;
        border-color: #66b1ff;
        color: #fff;
    }

</style>


</html>



